<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="style.css">

    <link rel="stylesheet" href="./main.css" />

</head>

<body>
    <nav>
        Random Sujet de vielle
    </nav>
    <div class="main">

        <div class="">

            <button onclick="arrdate()">test</button>
           <!--- <button onclick="readList()">afficher</button>-->
            <button onclick="bestRandom()">Random</button>
            <button onclick="getDate()">getdate</button>
            <div class="flex justify-center list_read">
                <ul id="read" class="bg-white bg-opacity-10 rounded-lg border border-gray-200 w-96 text-gray-900 ">
                    <li class="px-6 py-2 border-b border-gray-200 w-full rounded-t-lg">An item</li>
                    

                </ul>
            </div>
        </div>
        <div class="">

            <main>
                <section class="task-list flex">
                    <!--<h2>List</h2> -->

                    <div id="myList" class="place-content-center flex-1">
                        <!--<h2>Wich Date</h2>-->
                        <!--<input type="date"/>-->
                        <div class="">
                            <h2>Add Name üßëüèª‚Äçüíª </h2>
                            <form id="new-task-form">
                                <input type="text" name="new-task-input" id="new-task-input" placeholder="Name" />
                                <a id="new-task-submit" onclick="addList()" value="Add" /></a>
                            </form>


                        </div>

                        <div class="">
                            <div class="bg-violet-600 rounded-lg w-20 mb-2">
                                <button onclick="random()" class="az">Boom ! üí£</button>
                            </div>
                            <div class="rounded-lg  bg-[#1f2937] text-white">
                                Apprenant:
                                <br />
                                Date:
                                <br />
                                Sujet de vielle:
                            </div>
                        </div>

                </section>
            </main>
        </div>



        <script src="./main.js"></script>
        <script src="https://cdn.tailwindcss.com"></script>
        <script type="text/javascript">
            let a,newarr = [];
            const addList = () => {
                const input = document.querySelector("#new-task-input");
                const value = input.value;
                console.log(value)
                const data = {
                    name: value
                }
                fetch('http://localhost:3000/apprenant', {
                    method: 'POST', // or 'PUT'
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(data),
                })
                    .then((response) => console.log(response))
                    .catch((error) => {
                        console.error('Error:', error);
                    });
            }
            var getapprenant = [];
            var getdateRandom = [];
            const bestRandom = () => {
                fetch('http://localhost:3000/apprenant')
                .then(response=> response.json())
                .then(data => getapprenant  = data)
                
                //console.log(getapprenant,"getaprenant" )
                getapprenant =  shuffle(getapprenant)
                console.log(getapprenant,"shuffle")
            };
            function shuffle(arr){

                let max = arr.length, idRandom, c;
                a = max;
                
                //console.log(max)
                for(let i = 0; i < max; i++){
                    idRandom = Math.floor(Math.random() * max);
                    c = arr[i];
                    arr[i] = arr[idRandom];
                    arr[idRandom] = c;
                }
                return arr
                console.log(arr,"get new array apprenant")
                //console.log(arr,"arr")
            }
            // get array all Date
            // get arrdate filter weekend and hooliday 
            // count length array date if < number apprenant 
            // rest = arrdate.length - arraprenant.length 
            // max = rest 
            function getDate () {
               
                
                
            }
            let days = [];
            // get Date max nombre aprenant before filter
            function arrdate(){
                let getDate = new Date() ,
                getYear = getDate.getFullYear(),
                getMonth = getDate.getMonth()+1,
                getDay = getDate.getDay()*4;
                console.log(getDay)
                // get 31 days and 12 month

                if(getdateRandom < a){
                for(var i = 0; i< a ; i++){
                    var c = 0;
                    getDay = getDay+c+1;
                    // console.log("hello")
                    if(getDay > 31 ){
                        getDay = 1;
                        c = 1;
                        if(getMonth == 13){
                            getYear = getYear+1
                        }
                    }
                    getdateRandom.push([getYear,getMonth,getDay])  
                    
                    c++;
                }
                
                filterWeekend();

                }
                
                
                
            }

            // getName for filter weekend
            function getNameday(date){
                var d = new Date(date);
                var dayName  = d.toString().split(' ')[0];
                return dayName;
            }
            
            // filter week 
            function filterWeekend(){
                let weekend = ["Sat", "Sun"];
                
                
                // kayt3ta f lconsole 
                getdateRandom.map(item => days.push(getNameday(item)))
                //console.log(getdateRandom,"bbbbbb")
                //console.log(days,"days")
                
                for(var i = 0; i < a; i++ ){
                    newarr.push([getdateRandom[i],days[i]])   
                }

                //let arrfilter = days.filter(x => !weekend.includes(x));
                //console.log(arrfilter,"arrfilter")
                //if(newarr.indexOf('Sat') || newarr.indexOf('Sun')){
                   // newarr.map((item) => {
                       // if(item == "Sat" || item == "Sun"){
                      //  console.log("danger")
                    //}})
                    
                    // newarr = newarr.filter((day) => {
                         
                    //     console.log("ttt")
                    //    return day != "Sat" && day != "Sun" 
                  //  })

                //}
                // a = ap
                console.log(newarr,"newarr")
                console.log(weekend)
                for(var i = 0 ; i < newarr.length ; i++){
                    for(var j = 0 ; j < weekend.length ; j++){
                        
                        //console.log(newarr[i][1] + "&&" + weekend[j])
                        if(newarr[0][1] === weekend[j]) {
                            newarr.splice(0, 1);
                           console.log("splice")
                        }
                }
                console.log(newarr[i][1])
                }
                //for (var i = 0; i < a; i++) {
                //     console.log(newarr[i][1])
                 // if (newarr[i][1] == weekend[0] || newarr[i][1] == weekend[1]) {
                 //  newarr.splice(i, 1);
                 //  }
                //}

                
                
                //console.log(newarr[1][1],"newarr")
                //getdateRandom.map(item => console.log(getNameday(item)))
                return newarr
            }
            // filter Holiday
            function filterHoliday(){
               


            }











            
            //let arr;
            const readList = () => {
                fetch('http://localhost:3000/apprenant')
                .then(response=> response.json())
                .then(data =>  arr = data )
                console.log(arr.length)
                console.log(arr)
                var readli = document.createElement('ul');
                var n = arr.length
                var read = document.getElementById('read') ;
                for(var i = 0; i < n; i++) {
                   readli.value += arr[i].value
                   // console.log(readli.value,"afficher li")
                }
                read.appendChild(readli)
                
            }



            
            
            
               
                









            
            let number , arr = [],removearr =[],idRandom = 2 ;
            
            const random = () =>{
                fetch('http://localhost:3000/apprenant')
                .then(response =>response.json())
                .then(data => arr = data)
                .then(data =>number = data.length);
                
                let idRandom = Math.floor(Math.random() * number);
                console.log(dayRandom)
                //dayRandom.forEach(element => {
                    //element.day++
                //    console.log(element)
                //});
                //console.log(dayRando)
                    var i = 0;
                    let max = 0
                   
                    if( max == number+1){ 
                            console.log("done")
                         return 
                        }
                    
                        else if(!removearr.includes(idRandom)){
                       
                           
                            //console.log(idRandom)
                            //removearr.push(idRandom);
                            //console.log(arr[idRandom])
                            //console.log(removearr)
                           // max = removearr.length

                            
                        //}
                        //else{
                             //idRandom = Math.floor(Math.random() * number);
                             //console.log(idRandom)
                        }
                        // Array of date == number 
                        if(arrdate.includes(getMonth)  != true && arrdate.length < number ){
                            //console.log(getMonth,"r")
                            for(var i ; i<number; i++){
                                idRandom = Math.floor(Math.random() * number);
                                removearr.push(idRandom)

                            }
                            for(var i = 0 ;i <number; i++){
                            arrdate.push([month = getMonth,day = getDay])
                            //arrdate.push(getMonth)
                            //console.log(getMonth, "month");
                            //getMonth = getMonth+1
                            if(getDay == 31 && getMonth == 12 ){
                                getDay == 1;
                                getMonth == 1;
                            }
                            // khdma dyal nhar y incrementa m3a chher moraha ychof ila kayn f holday yzed y incrementi 
                            getDay = getDay+1;
                            
                        }
                            console.log(arrdate,"arraydate",removearr,"removearr")
                            removearr.forEach(element => console.log(element))
                        }else{
                            
                            //console.log(arrdate)
                        }



                    
                        //    idRandom = Math.floor(Math.random() * number);
                        //    console.log("hello random")
                        
                    
                    
                    //if(removearr.includes(idRandom)){
                    //    console.log("if")
                    //}
                    //else{
                    //    idRandom = Math.floor(Math.random() * number);
                    //    localStorage.setItem("id",idRandom+1);
                    //    removearr.push(localStorage.getItem("id"))
                    //    console.log("hello",removearr);
                    //    a = 1;
                    //}
                    //idRandom = Math.floor(Math.random() * number);
                    //removearr.push(localStorage.getItem("id"))
    
                    //console.log(removearr,"remove")
                   //}
                //idRandom = Math.floor(Math.random() * number);
                //localStorage.setItem("id",idRandom+1)
                //removearr.push(localStorage.getItem("id"))

                //console.log(removearr,"remove")
                //localStorage.setItem('monChat', 'Tom');
                //console.log(localStorage.getItem('monChat'))
                //console.log(arr[idRandom])
                ///arr = arr.filter(item => item != item[idRandom])
                //arr.splice(idRandom, 1)
                //console.log(arr)
                //console.log(arr[idRandom],getDay,getMonth,getYear)
            }
            

            
            
            </script>
            <!--fetch('http://localhost:3000/apprenant').then((data)=> console.log(data.json))-->
</body>

</html>